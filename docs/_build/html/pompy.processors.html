
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>processors module &#8212; pompy 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="demos module" href="pompy.demos.html" />
    <link rel="prev" title="models module" href="pompy.models.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pompy.demos.html" title="demos module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pompy.models.html" title="models module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pompy 0.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-pompy.processors">
<span id="processors-module"></span><h1><cite>processors</cite> module<a class="headerlink" href="#module-pompy.processors" title="Permalink to this headline">¶</a></h1>
<p>Helper classes to process outputs of models.</p>
<dl class="class">
<dt id="pompy.processors.ConcentrationValueCalculator">
<em class="property">class </em><code class="descclassname">pompy.processors.</code><code class="descname">ConcentrationValueCalculator</code><span class="sig-paren">(</span><em>puff_molecular_amount</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationValueCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationValueCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates odour concentration values in simulation region.</p>
<dl class="method">
<dt id="pompy.processors.ConcentrationValueCalculator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>puff_molecular_amount</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationValueCalculator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationValueCalculator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>puff_molecular_amount</strong> (<em>float</em>) – Molecular content of each puff (e.g. in moles or raw number of
molecules). This is conserved as the puff is transported within
the plume but the puff becomes increasingly diffuse as it’s radius
grows due to diffusion.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pompy.processors.ConcentrationValueCalculator.calc_conc_point">
<code class="descname">calc_conc_point</code><span class="sig-paren">(</span><em>puff_array</em>, <em>x</em>, <em>y</em>, <em>z=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationValueCalculator.calc_conc_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationValueCalculator.calc_conc_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate concentration at a single point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>puff_array</strong> (<em>array</em>) – 2D array of puff properties of shape <cite>(n_puffs, 4)</cite> with <cite>n_puffs</cite>
being the number of puffs and the four columns of the array
corresponding in order to the puff x-coordinates, y-coordinates,
z-coordinates and squared radii.</li>
<li><strong>x</strong> (<em>float</em>) – x-coordinate of point.</li>
<li><strong>y</strong> (<em>float</em>) – y-coordinate of point.</li>
<li><strong>z</strong> (<em>float</em>) – z-coordinate of point.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pompy.processors.ConcentrationValueCalculator.calc_conc_list">
<code class="descname">calc_conc_list</code><span class="sig-paren">(</span><em>puff_array</em>, <em>x</em>, <em>y</em>, <em>z=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationValueCalculator.calc_conc_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationValueCalculator.calc_conc_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate concentrations across a 1D list of points in a xy-plane.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>puff_array</strong> (<em>array</em>) – 2D array of puff properties of shape <cite>(n_puffs, 4)</cite> with <cite>n_puffs</cite>
being the number of puffs and the four columns of the array
corresponding in order to the puff x-coordinates, y-coordinates,
z-coordinates and squared radii.</li>
<li><strong>x</strong> (<em>array</em>) – 1D array of x-coordinates of points.</li>
<li><strong>y</strong> (<em>array</em>) – 1D array of y-coordinates of points.</li>
<li><strong>z</strong> (<em>float</em>) – z-coordinate (height) of plane.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pompy.processors.ConcentrationValueCalculator.calc_conc_grid">
<code class="descname">calc_conc_grid</code><span class="sig-paren">(</span><em>puff_array</em>, <em>x</em>, <em>y</em>, <em>z=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationValueCalculator.calc_conc_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationValueCalculator.calc_conc_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate concentrations across a 2D grid of points in a xy-plane.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>puff_array</strong> (<em>array</em>) – 2D array of puff properties of shape <cite>(n_puffs, 4)</cite> with <cite>n_puffs</cite>
being the number of puffs and the four columns of the array
corresponding in order to the puff x-coordinates, y-coordinates,
z-coordinates and squared radii.</li>
<li><strong>x</strong> (<em>array</em>) – 2D array of x-coordinates of grid points.</li>
<li><strong>y</strong> (<em>array</em>) – 2D array  of y-coordinates of grid points.</li>
<li><strong>z</strong> (<em>float</em>) – z-coordinate (height) of grid plane.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pompy.processors.ConcentrationArrayGenerator">
<em class="property">class </em><code class="descclassname">pompy.processors.</code><code class="descname">ConcentrationArrayGenerator</code><span class="sig-paren">(</span><em>array_xy_region</em>, <em>array_z</em>, <em>n_x</em>, <em>n_y</em>, <em>puff_mol_amount</em>, <em>kernel_rad_mult=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationArrayGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationArrayGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces odour concentration field arrays from puff property arrays.</p>
<p>Instances of this class can take single or multiple arrays of puff
properties outputted from a <cite>PlumeModel</cite> and process them to produce an
array of the concentration values across the a specified region using
a Gaussian model for the individual puff concentration distributions.</p>
<p>Compared to the <cite>ConcentrationValueCalculator</cite> class, this class should be
more efficient for calculating large concentration field arrays for
real-time graphical display of odour concentration fields for example
at the expense of  less accurate values due to the truncation of spatial
extent of each puff.</p>
<p class="rubric">Notes</p>
<p>The returned array values correspond to the point concentration
measurements across a regular grid of sampling points - i.e. the
equivalent to convolving the true continuous concentration distribution
with a regular 2D grid of Dirac delta / impulse functions. An improvement
in some ways would be to instead calculate the integral of the
concentration distribution over the (square) region around each grid point
however this would be extremely computationally costly and due to the lack
of a closed form solution for the integral of a Gaussian also potentially
difficult to implement without introducing other numerical errors. An
integrated field can be approximated with this class by generating an
array at a higher resolution than required and then filtering with a
suitable kernel and down-sampling.</p>
<p>This implementation estimates the concentration distribution puff kernels
with sub-grid resolution, giving improved accuracy at the cost of
increased computational cost versus using a precomputed radial field
aligned with the grid to compute kernel values or using a library of
precomputed kernels.</p>
<p>For cases where the array region cover the whole simulation region the
computational cost could also be reduced by increasing the size of the
region the array corresponds to outside of the simulation region such that
when adding the puff concentration kernels to the concentration field
array, checks do not need to be made to restrict to the overlapping region
for puffs near the edges of the simulation region which have a
concentration distribution which extends beyond its extents.</p>
<dl class="method">
<dt id="pompy.processors.ConcentrationArrayGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>array_xy_region</em>, <em>array_z</em>, <em>n_x</em>, <em>n_y</em>, <em>puff_mol_amount</em>, <em>kernel_rad_mult=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationArrayGenerator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationArrayGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array_region</strong> (<a class="reference internal" href="pompy.models.html#pompy.models.Rectangle" title="pompy.models.Rectangle"><em>Rectangle</em></a>) – Two-dimensional rectangular region defined in world coordinates
over which to calculate the concentration field.</li>
<li><strong>array_z</strong> (<em>float</em>) – Height on the vertical z-axis at which to calculate the
concentration field over.</li>
<li><strong>n_x</strong> (<em>integer</em>) – Number of grid points to sample at across x-dimension.</li>
<li><strong>n_y</strong> (<em>integer</em>) – Number of grid points to sample at across y-dimension.</li>
<li><strong>puff_mol_amount</strong> (<em>float</em>) – Molecular content of each puff (e.g. in moles or raw number of
molecules). This is conserved as the puff is transported within
the plume but the puff becomes increasingly diffuse as its radius
grows due to diffusion.
(dimensionality:molecular amount)</li>
<li><strong>kernel_rad_mult</strong> (<em>float</em>) – Multiplier used to determine to within how many puff radii from
the puff centre to truncate the concentration distribution
kernel calculated to. The default value of 3 will truncate the
Gaussian kernel at (or above) the point at which the concentration
has dropped to 0.004 of the peak value at the puff centre.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pompy.processors.ConcentrationArrayGenerator.generate_single_array">
<code class="descname">generate_single_array</code><span class="sig-paren">(</span><em>puff_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationArrayGenerator.generate_single_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationArrayGenerator.generate_single_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a single concentration field array from a puff array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>puff_array</strong> (<em>array</em>) – 2D array of puff properties of shape <cite>(n_puffs, 4)</cite> with <cite>n_puffs</cite>
being the number of puffs and the four columns of the array
corresponding in order to the puff x-coordinates, y-coordinates,
z-coordinates and squared radii.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>conc_array</strong> – 2D array of shape <cite>(n_x, n_y)</cite> containing concentration field
values at specified grid points.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pompy.processors.ConcentrationArrayGenerator.generate_multiple_arrays">
<code class="descname">generate_multiple_arrays</code><span class="sig-paren">(</span><em>puff_arrays</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pompy/processors.html#ConcentrationArrayGenerator.generate_multiple_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pompy.processors.ConcentrationArrayGenerator.generate_multiple_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates multiple concentration field arrays from puff arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>puff_arrays</strong> (<em>array iterable</em>) – Iterable sequence of 2D arrays of puff properties, with each array
of shape <cite>(n_puffs, 4)</cite> with <cite>n_puffs</cite> being the number of puffs
and the four columns of the array corresponding in order to the
puff x-coordinates, y-coordinates, z-coordinates and squared radii.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>conc_arrays</strong> – List of 2D arrays of shape <cite>(n_x, n_y)</cite> containing concentration
field values at specified grid points, with each array in list
corresponding to the puff properties array at the corresponding
index in <cite>puff_arrays</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array iterable</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="pompy.models.html"
                        title="previous chapter"><cite>models</cite> module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pompy.demos.html"
                        title="next chapter"><cite>demos</cite> module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pompy.processors.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pompy.demos.html" title="demos module"
             >next</a> |</li>
        <li class="right" >
          <a href="pompy.models.html" title="models module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pompy 0.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Matt Graham.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>